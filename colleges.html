<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Colleges | Pathfinder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0b0b0b;     /* matte black */
      --panel:#151515;  /* dark gray panel */
      --line:#2a2a2a;
      --text:#efeff2;
      --muted:#a8b0c2;
      --accent:#5aa6ff;
      --ok:#1ed760; --warn:#ffcc00; --danger:#ff5c5c;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:'Outfit',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      background:var(--bg);
      color:var(--text);
    }
    a{color:#cfe1ff;text-decoration:none}
    a:hover{color:#fff}

    /* simple top nav */
    header{
      position:sticky;top:0;z-index:5;
      background:#0f0f10; border-bottom:1px solid var(--line);
    }
    .nav{
      max-width:1200px;margin:0 auto;
      padding:14px 18px; display:flex; align-items:center; justify-content:space-between;
    }
    .brand{display:flex;align-items:center;gap:8px;font-weight:700}
    .dot{width:10px;height:10px;border-radius:50%;background:var(--accent)}
    .links{display:flex;gap:10px}
    .links a{padding:8px 10px;border-radius:10px;color:#cfd7ea}
    .links a.active{background:#1a1a1a;border:1px solid var(--line);color:#fff}

    main{max-width:1200px;margin:0 auto;padding:20px 18px}

    h1{font-size:26px;margin:8px 0 6px}
    .lead{color:#b7bed2;margin:0 0 16px}

    .panel{
      background:var(--panel);
      border:1px solid var(--line);
      border-radius:14px;
      padding:16px;
    }

    .grid{
      display:grid; gap:12px;
    }
    @media(min-width:860px){
      .grid{grid-template-columns:2fr 1fr 1fr 1fr}
    }

    label{display:block;font-size:13px;color:#b7bed2;margin-bottom:6px}
    input,select,button{
      width:100%; padding:12px 12px; border-radius:10px;
      background:#0f0f10; color:var(--text); border:1px solid var(--line);
      font-size:15px;
    }
    input:focus,select:focus,button:focus{outline:none;border-color:#3b72c7; box-shadow:0 0 0 3px rgba(90,166,255,.15)}
    button{cursor:pointer;font-weight:700;background:#1c2740}
    button:hover{filter:brightness(1.05)}

    .legend{display:flex;gap:10px;flex-wrap:wrap;margin:10px 0 0}
    .tag{font-size:12px;padding:5px 9px;border-radius:999px;border:1px solid #00000022;display:inline-block}
    .safety{background:rgba(30,215,96,.15);color:#a6f0bf;border-color:rgba(30,215,96,.35)}
    .target{background:rgba(255,204,0,.12);color:#ffe08a;border-color:rgba(255,204,0,.35)}
    .reach{background:rgba(255,92,92,.14);color:#ffb6b6;border-color:rgba(255,92,92,.35)}

    .count{color:#b7bed2;font-size:14px;margin:10px 0}

    .table-wrap{overflow:auto;border-radius:12px;border:1px solid var(--line)}
    table{width:100%;border-collapse:separate;border-spacing:0}
    thead th{
      text-align:left; font-size:12px; letter-spacing:.05em; text-transform:uppercase;
      color:#aeb7cb; background:#161616; padding:10px 12px; border-bottom:1px solid var(--line);
      position:sticky; top:0; z-index:1;
    }
    tbody td{padding:14px 12px;border-bottom:1px solid #1f1f1f}
    tbody tr:hover{background:#121212}
    .note{color:#9aa4b9;font-size:12px}

    .footnote{color:#9aa4b9;font-size:12px;margin-top:8px}
  </style>
</head>
<body>
  <header>
    <div class="nav">
      <div class="brand"><span class="dot"></span> Pathfinder</div>
      <div class="links">
        <a href="index.html">Home</a>
        <a href="explore.html">Explore</a>
        <a class="active" href="colleges.html">Colleges</a>
      </div>
    </div>
  </header>

  <main>
    <h1>Find Colleges by GPA & Major</h1>
    <p class="lead">Type your (weighted) GPA, pick a major, and filter if you want. Results update instantly.</p>

    <!-- Filters -->
    <section class="panel" aria-label="Filters">
      <div class="grid">
        <div>
          <label for="gpa">Weighted GPA</label>
          <input id="gpa" type="number" min="0" max="5" step="0.01" placeholder="e.g., 4.10">
        </div>
        <div>
          <label for="major">Major</label>
          <input list="majors" id="major" placeholder="Start typing…">
          <datalist id="majors"></datalist>
        </div>
        <div>
          <label for="system">System</label>
          <select id="system">
            <option value="ALL">All</option>
            <option value="UC">UC</option>
            <option value="CSU">CSU</option>
            <option value="Private">Private</option>
          </select>
        </div>
        <div>
          <label for="minrate">Min admit rate</label>
          <select id="minrate">
            <option value="0">Any</option>
            <option value="10">≥ 10%</option>
            <option value="20">≥ 20%</option>
            <option value="30">≥ 30%</option>
          </select>
        </div>
      </div>

      <div class="legend">
        <span class="tag safety">Safety</span>
        <span class="tag target">Target</span>
        <span class="tag reach">Reach</span>
        <span class="note">Bands use midpoint GPA estimates. Replace with verified numbers when ready.</span>
      </div>
    </section>

    <!-- Results -->
    <section style="margin-top:14px">
      <div class="count" id="count">No results yet.</div>
      <div class="table-wrap">
        <table id="results">
          <thead>
            <tr>
              <th>College</th>
              <th>System</th>
              <th>Fit</th>
              <th>Midpoint GPA</th>
              <th>Admit rate</th>
              <th>Links</th>
            </tr>
          </thead>
          <tbody id="rows">
            <!-- filled by JS -->
          </tbody>
        </table>
      </div>
      <p class="footnote">Tip: you can share a link like <code>?gpa=4.12&major=Computer%20Science</code> to pre-fill the filters.</p>
    </section>
  </main>

  <script>
    // Simple, human-sized list. Update/expand as you verify data.
    const MAJORS = [
      "Electrical Engineering","Mechanical Engineering","Civil Engineering","Materials Science",
      "Computer Science","Mathematics","Psychology","Business Administration","Finance","Nursing","Liberal Arts"
    ];

    // Small demo dataset. midByMajor overrides midGpa when present.
    const COLLEGES = [
      {name:"UC Berkeley", system:"UC", midGpa:4.25, admitRate:12, majors:["Electrical Engineering","Mechanical Engineering","Computer Science","Mathematics","Materials Science","Liberal Arts"], midByMajor:{"Electrical Engineering":4.28,"Computer Science":4.30,"Mathematics":4.18,"Liberal Arts":4.08}},
      {name:"UCLA", system:"UC", midGpa:4.23, admitRate:11, majors:["Electrical Engineering","Mechanical Engineering","Computer Science","Psychology","Mathematics","Liberal Arts"], midByMajor:{"Electrical Engineering":4.26,"Computer Science":4.29,"Psychology":4.15,"Mathematics":4.17,"Liberal Arts":4.05}},
      {name:"UC San Diego", system:"UC", midGpa:4.15, admitRate:24, majors:["Electrical Engineering","Mechanical Engineering","Computer Science","Mathematics","Materials Science","Liberal Arts"], midByMajor:{"Computer Science":4.22,"Electrical Engineering":4.18,"Mathematics":4.06,"Liberal Arts":3.98}},
      {name:"UC Santa Barbara", system:"UC", midGpa:4.10, admitRate:26, majors:["Mechanical Engineering","Computer Science","Mathematics","Psychology","Liberal Arts"], midByMajor:{"Mechanical Engineering":4.16,"Computer Science":4.14,"Mathematics":4.02,"Liberal Arts":3.95}},
      {name:"UC Irvine", system:"UC", midGpa:4.08, admitRate:28, majors:["Electrical Engineering","Mechanical Engineering","Computer Science","Business Administration","Nursing","Liberal Arts"], midByMajor:{"Nursing":4.20,"Computer Science":4.14,"Electrical Engineering":4.06,"Business Administration":3.98,"Liberal Arts":3.90}},
      {name:"Cal Poly SLO", system:"CSU", midGpa:4.05, admitRate:29, majors:["Electrical Engineering","Mechanical Engineering","Materials Science","Business Administration","Computer Science","Mathematics","Liberal Arts"], midByMajor:{"Computer Science":4.10,"Mechanical Engineering":4.08,"Liberal Arts":3.85}},
      {name:"San Diego State", system:"CSU", midGpa:3.90, admitRate:38, majors:["Electrical Engineering","Mechanical Engineering","Computer Science","Business Administration","Nursing","Mathematics","Liberal Arts"], midByMajor:{"Nursing":4.00,"Computer Science":3.95}},
      {name:"USC", system:"Private", midGpa:4.15, admitRate:12, majors:["Business Administration","Computer Science","Mechanical Engineering","Electrical Engineering","Mathematics","Liberal Arts"], midByMajor:{"Business Administration":4.05,"Computer Science":4.18}},
      {name:"Stanford", system:"Private", midGpa:4.30, admitRate:4, majors:["Computer Science","Mathematics","Electrical Engineering","Liberal Arts"], midByMajor:{"Computer Science":4.33,"Mathematics":4.25}}
    ];

    const majorsDL = document.getElementById('majors');
    MAJORS.forEach(m => majorsDL.insertAdjacentHTML('beforeend', `<option value="${m}">`));

    const gpaEl = document.getElementById('gpa');
    const majorEl = document.getElementById('major');
    const sysEl = document.getElementById('system');
    const minRateEl = document.getElementById('minrate');
    const rowsEl = document.getElementById('rows');
    const countEl = document.getElementById('count');

    // helpers
    function getMidpoint(c, m){
      if (c.midByMajor && c.midByMajor[m]) return c.midByMajor[m];
      return c.midGpa;
    }
    function classify(gpa, mid){
      if (isNaN(gpa) || isNaN(mid)) return {band:"—"};
      const diff = +(gpa - mid).toFixed(2);
      if (diff >= 0.20) return {band:"Safety", diff};
      if (Math.abs(diff) <= 0.15) return {band:"Target", diff};
      return {band:"Reach", diff};
    }
    function fitClass(b){ return b==="Safety"?"safety":(b==="Target"?"target":"reach"); }
    function admissionsUrl(name){ return `https://www.google.com/search?q=${encodeURIComponent(name+' undergraduate admissions')}`; }

    function clampGpa(){
      let v = parseFloat(gpaEl.value);
      if (isNaN(v)) return NaN;
      v = Math.max(0, Math.min(5, v));
      gpaEl.value = v.toFixed(2);
      return v;
    }

    function analyze(){
      const g = clampGpa();
      const m = (majorEl.value || "").trim();
      const sys = sysEl.value;
      const minR = parseInt(minRateEl.value, 10) || 0;

      let data = COLLEGES
        .filter(c => (sys === "ALL" ? true : c.system === sys))
        .filter(c => c.admitRate >= minR)
        .filter(c => !m || (c.majors || []).includes(m))
        .map((c, i) => {
          const mid = getMidpoint(c, m);
          const fit = classify(g, mid);
          return {id:i, name:c.name, system:c.system, mid, rate:c.admitRate, fit, major:m};
        });

      // sort Safety -> Target -> Reach, then by mid
      const rank = b => b==="Safety"?0 : b==="Target"?1 : b==="Reach"?2 : 3;
      data.sort((a,b)=> rank(a.fit.band)-rank(b.fit.band) || a.mid-b.mid);

      render(data);
    }

    function render(items){
      rowsEl.innerHTML = "";
      if (!items.length){
        countEl.textContent = "No results yet. Enter GPA and choose a major.";
        return;
      }
      const tally = items.reduce((acc,r)=>{ acc[r.fit.band]=(acc[r.fit.band]||0)+1; return acc; },{});
      countEl.textContent = `${items.length} result${items.length===1?"":"s"} — ${tally.Safety||0} Safety • ${tally.Target||0} Target • ${tally.Reach||0} Reach`;

      items.forEach(r=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${r.name}</td>
          <td>${r.system}</td>
          <td><span class="tag ${fitClass(r.fit.band)}">${r.fit.band}</span></td>
          <td>${isFinite(r.mid)? r.mid.toFixed(2) : "—"}</td>
          <td>${r.rate}%</td>
          <td>
            <a href="${admissionsUrl(r.name)}" target="_blank" rel="noopener">Admissions</a>
          </td>
        `;
        rowsEl.appendChild(tr);
      });
    }

    // events
    function debounce(fn,ms){ let t; return (...a)=>{ clearTimeout(t); t=setTimeout(()=>fn(...a),ms); }; }
    const run = debounce(analyze, 150);

    [gpaEl, majorEl, sysEl, minRateEl].forEach(el=>{
      el.addEventListener('input', run);
      el.addEventListener('change', run);
      el.addEventListener('keydown', e=>{ if(e.key==='Enter'){ e.preventDefault(); analyze(); }});
    });

    // init from URL (?gpa=&major=)
    (function init(){
      const params = new URL(location.href).searchParams;
      const qpG = params.get('gpa'); const qpM = params.get('major');
      if (qpG) gpaEl.value = qpG;
      if (qpM) majorEl.value = qpM;
      if (!gpaEl.value) gpaEl.value = "4.00";
      analyze();
    })();
  </script>
</body>
</html>
